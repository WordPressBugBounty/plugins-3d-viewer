(()=>{"use strict";var e={};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),(()=>{var t;e.g.importScripts&&(t=e.g.location+"");var r=e.g.document;if(!t&&r&&(r.currentScript&&"SCRIPT"===r.currentScript.tagName.toUpperCase()&&(t=r.currentScript.src),!t)){var n=r.getElementsByTagName("script");if(n.length)for(var a=n.length-1;a>-1&&(!t||!/^http(s?):/.test(t));)t=n[a--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),e.p=t})();const t=window.React,r=function(e,t="string"){if(e){if("transparent"===e)return{r:255,g:255,b:255,a:0};if(e.includes("rgba")){const t=e.match(/rgba?\((\d+),(\d+),(\d+)(?:,([\d.]+))?\)/);if(t){const[,e,r,n,a=1]=t.map(Number);return{r:e,g:r,b:n,a}}return null}var r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})?$/i.exec(e.replace("#",""));return r?{r:parseInt(r[1],16),g:parseInt(r[2],16),b:parseInt(r[3],16),a:parseInt(r[4],16)?parseInt(r[4],16):0===parseInt(r[4],16)?0:255}:null}},n=class{constructor(e){window.model=e,this.model=e,this.copy=null,this.thumbnailsById=new Map,this.thumbnail_size=256,this.textures=[],this.texturesArray=[],this.textureChannels=[],this.defaultMaterialData=null,this.initialized=!1,this.sizes=[],this.copy=null,this.readyCallbacks=[],this.isReady=!1,this.model.loaded?this.onLoad():this.model.addEventListener("load",this.onLoad.bind(this))}initialize(){this.isReady=!0,this.readyCallbacks.forEach(e=>e()),this.readyCallbacks=[]}onReady(e){this.isReady?e():this.readyCallbacks.push(e)}async onLoad(){if(this.modelUrl=this.model.src,this.getDefaultMaterialData(),this.thumbnailsById=await this.createThumbnails(),window.pagenow){const e=await this.loadModelWithoutAppending(this.model.src+"?"+Date.now());this.copy=e.model;const t=await this.createThumbnails(new Map,this.copy.materials);this.copy.thumbnailsById=t}this.initialize()}getTextureId(e){var t;return null!==(t=e.uri)&&void 0!==t?t:e.bufferView.toString()}async getTextures(){return 0===Object.keys(this.textures).length&&this.model&&await this.createThumbnails(),this.textures}async getBlobFileSize(e){try{const t=await fetch(e);if(!t.ok)throw new Error("Failed to fetch the Blob URL");return(await t.blob()).size}catch(e){return console.error("Error getting Blob file size:",e),null}}async pushThumbnail(e,t){const{texture:r}=t||{};if(!r||!r.source)return null;const n=this.getTextureId(r.source);if(!e.has(n)){const t=await r.source.createThumbnail(this.thumbnail_size,this.thumbnail_size),a=await this.getBlobFileSize(t);e.set(n,{objectUrl:t,texture:r,size:a,id:n}),this.textures[n]||(this.texturesArray.push(n),this.textures[n]=t,this.sizes[n+"_"+a]=t)}return n}async createThumbnails(e,t=this.model.model?.materials){e||(e=new Map);for(const r of t||[]){await r.ensureLoaded();const{pbrMetallicRoughness:t,normalTexture:n,emissiveTexture:a,occlusionTexture:l}=r,{baseColorTexture:o,metallicRoughnessTexture:s}=t;await this.pushThumbnail(e,n),await this.pushThumbnail(e,a),await this.pushThumbnail(e,l),await this.pushThumbnail(e,o),await this.pushThumbnail(e,s)}return e}getAllMaterialData(){if(!this.model.model)return console.warn("Model not loaded yet."),{};const e={};return this.model.model.materials.forEach(async t=>{await t.ensureLoaded();const r=t.name||`Material_${Math.random().toString(36).substr(2,5)}`;e[r]={baseColor:{texture:{name:t.pbrMetallicRoughness.baseColorTexture?.texture?.source.name||null,uri:t.pbrMetallicRoughness.baseColorTexture?.texture?.source.uri||null},factor:t.pbrMetallicRoughness.baseColorFactor||[1,1,1,1]},metallicRoughness:{texture:{name:t.pbrMetallicRoughness.metallicRoughnessTexture?.texture?.source.name||null,uri:t.pbrMetallicRoughness.metallicRoughnessTexture?.texture?.source.uri||null},factor:[t.pbrMetallicRoughness.metallicFactor||1,t.pbrMetallicRoughness.roughnessFactor||1]},normal:{texture:{uri:t.normalTexture?.texture?.source.uri||null,name:t.normalTexture?.texture?.source.name||null}},emissive:{texture:{name:t.emissiveTexture?.texture?.source.name||null,uri:t.emissiveTexture?.texture?.source.uri||null},factor:t.emissiveFactor||[0,0,0]},occlusion:{texture:{name:t.occlusionTexture?.texture?.source.name||null,uri:t.occlusionTexture?.texture?.source.uri||null}}}}),e}getDefaultMaterialData(){return this.defaultMaterialData||(this.defaultMaterialData=this.getAllMaterialData()),this.defaultMaterialData}async updateMaterialTextureAndFactor(e,t,r,n=null,a=`texture_${Date.now()}`){if(this.model?.model&&e)if(r&&("baseColor"===t&&e.pbrMetallicRoughness.setBaseColorFactor(s(r)),"metallicRoughness"===t&&(e.pbrMetallicRoughness.setMetallicFactor(r[0]),e.pbrMetallicRoughness.setRoughnessFactor(r[1])),"emissive"===t&&e.setEmissiveFactor(s(r))),"default"!==n){if(!n)return t.includes("base")||t.includes("metallic")?e.pbrMetallicRoughness[t+"Texture"].setTexture(null):e[t+"Texture"].setTexture(null),void console.log(`Removed texture from '${t}' of material '${e.name}'.`);try{"string"==typeof n&&((n=await this.model.createTexture(n)).name=a),t.includes("base")||t.includes("metallic")?e.pbrMetallicRoughness[t+"Texture"].setTexture(n):e[t+"Texture"].setTexture(n),console.log(`Applied new texture ${a} to '${t}' of material '${e.name}'.`)}catch(e){console.error("Error creating texture:",e)}}else{if(t.includes("base")||t.includes("metallic")){const r=this.copy.getMaterialByName(e.name).pbrMetallicRoughness[t+"Texture"].texture;e.pbrMetallicRoughness[t+"Texture"].setTexture(r)}else{const r=this.copy.getMaterialByName(e.name)[t+"Texture"].texture;e[t+"Texture"].setTexture(r)}console.log(`Removed texture from '${t}' of material '${e.name}'.`)}else console.warn("Model or Material not found.")}async applyTexture(e,t=null,r=null){if(window.modelReader=this,e){if(t&&r){const{name:n,url:a}=e[t]?.[r]?.texture||{},l=this.model?.model?.getMaterialByName(t);let o=a||this.getTextureByName(n);e[t]?.[r]?.texture||(o="default");const s=e[t]?.[r]?.factor||null;return void this.updateMaterialTextureAndFactor(l,r,s,o,n)}Object.entries(e).forEach(([e,t])=>{const r=this.model?.model?.getMaterialByName(e);r?Object.keys(t).forEach(e=>{const{name:n,url:a}=t[e]?.texture||{};let l=a||this.getTextureByName(n);t[e]?.texture||(l="default");const o=t[e]?.factor||null;this.updateMaterialTextureAndFactor(r,e,o,l,n)}):console.warn(`Material '${e}' not found.`)})}}async shakeMaterialFactor(e,t=500){if(!e)return;"string"==typeof e&&(e=this.getMaterialByName(e));const r=e.pbrMetallicRoughness.baseColorFactor.slice();e.pbrMetallicRoughness.setBaseColorFactor([1,0,0,1]),setTimeout(()=>{e.pbrMetallicRoughness.setBaseColorFactor(r)},t)}getTextureURIByName(e){return e.includes("blob")?e:this.textures[e]||null}getMaterialByName(e){return this.model.model.getMaterialByName(e)}getTexturesArray(){return this.texturesArray}getTextureChannels(){return[{label:"Base Color",value:"baseColor"},{label:"Metallic Roughness",value:"metallicRoughness"},{label:"Normal Map",value:"normal"},{label:"Emissive",value:"emissive"},{label:"Occlusion",value:"occlusion"}]}getMaterialsNameForSelectControl(){return this.model.loaded?Array.isArray(this.model.model.materials)?this.model.model.materials.map(e=>({label:e.name.replace("_mtl","").replaceAll("_"," "),value:e.name})):[]:(console.warn("Model not loaded yet"),[])}getFirstMaterialName(){return this.model.loaded&&this.model.model?Array.isArray(this.model.model.materials)?this.model.model.materials[0].name:null:(console.warn("Model not loaded yet"),null)}getTextureById(e){return this.thumbnailsById.get(e)}async downloadTexture(e,t=512){const{texture:r=null}=this.getTextureById(e);if(!r)return void console.error("Texture not found!");const n=await r.source.createThumbnail(t,t),a=document.createElement("canvas");a.width=t,a.height=t;const l=a.getContext("2d"),o=new Image;o.crossOrigin="anonymous",o.src=n,o.onload=()=>{l.drawImage(o,0,0,t,t);const r=document.createElement("a");r.href=a.toDataURL("image/png"),r.download=`texture_${e}.png`,r.click()},o.onerror=()=>{console.error("Failed to load texture image.")}}deepCloneModel(){const e=this.model.originalModel.clone(!0);return e.traverse(e=>{e.isMesh&&(e.material&&(e.material=e.material.clone()),e.geometry&&(e.geometry=e.geometry.clone()),e.material.map&&(e.material.map=e.material.map.clone(),e.material.map.needsUpdate=!0))}),e}async loadModelWithoutAppending(e){return new Promise((t,r)=>{const n=document.createElement("model-viewer");n.src=e,n.setAttribute("loading","eager"),n.style.display="none",n.style.height="0",document.body.appendChild(n),n.addEventListener("load",()=>{t(n)}),n.addEventListener("error",e=>{r(new Error(`Model failed to load: ${e.message}`))})})}getTextureByName(e){if(!e)return null;try{if(this.copy?.thumbnailsById)return this.copy.thumbnailsById.get(e).texture;if(this.thumbnailsById)return this.thumbnailsById.get(e)?.texture}catch(t){console.error(t.message,e)}return null}createCopy(){}};function a(e){return e.replace(/-\d{2,4}x\d{2,4}/g,"")}function l(e){return/\.(jpg|jpeg|png|gif|bmp|svg|webp)$/i.test(e)}function o(e){return(e/=255)<=.04045?e/12.92:((e+.055)/1.055)**2.4}function s(e){if(!["rgba","rgb"].includes((t=e,/^rgba\(\s*\d{1,3}\s*,\s*\d{1,3}\s*,\s*\d{1,3}\s*,\s*(0|1|0?\.\d+)\s*\)$/i.test(t)?"rgba":!!/^rgb\(\s*\d{1,3}\s*,\s*\d{1,3}\s*,\s*\d{1,3}\s*\)$/i.test(t)&&"rgb")))return e;var t;const r=e.match(/rgba?\((\d+),\s*(\d+),\s*(\d+),\s*([\d.]+)\)/);if(!r)return null;const[n,a,l,s,i]=r.map(Number);return[o(a),o(l),o(s),i]}function i(e){if(!e)return null;let t=document.querySelector(l(e)?`img[src="${e}"]`:e.includes("#")||e.includes(".")?e:`.${e}`);return l(e)&&(t||(t=document.querySelector(`img[data-src="${e}"]`)),t||(t=document.querySelector(`img[data-src="${a(e)}"]`)),t||(t=document.querySelector(`img[src="${a(e)}"]`)),t||(t=document.querySelector(`a[href="${a(e)}"]`))),t&&(t=function(e){let t=e.parentElement;for(;t&&1===t.children.length;)e=t,t=t.parentElement;return e}(t),t?.innerHTML?.includes("<a")&&t.classList.add("bp3dv_a_popup_opener"),t?.innerHTML?.includes("<img")&&"reintest.be"===window.location.host&&t.classList.add("bp3dv_play_icon")),t}const c=({attributes:e})=>{const{styles:r,uniqueId:n,woo:a,progressBar:l,additional:o}=e,{progressBarColor:s,thumbSize:i="90px"}=r,[c,u]=(0,t.useState)(null);return(0,t.useEffect)(()=>{const e=`\n        #${n} {\n            width: ${r?.width?.desktop||r.width};\n            height: calc(${r?.height?.desktop||r.height});\n        }\n        .pop-up-content-wrap #${n} {\n            height: ${r?.height?.desktop||r.height};\n        }\n        #${n} .select {display: none}\n        \n        #${n} model-viewer {\n            background: ${r?.bgColor} ${r?.bgImage?`url(${r?.bgImage})`:" "} no-repeat center center;\n            background-size: cover;\n        }\n        #${n} model-viewer::part(default-progress-bar) {\n             display: ${l?"block":"none"}\n        }\n        #${n} .online_3d_viewer,\n        #${n} .b3dviewer-wrapper {\n            width: ${a?"100%":`${r?.width.desktop||r.width}`};\n            height: ${r?.height.desktop||r.height};\n        }\n        @media screen and (max-width: 1024px){\n            #${n} .online_3d_viewer,\n            #${n} .b3dviewer-wrapper {\n                width: ${a?"100%":`${r?.width.tablet||r.width}`};\n                height: ${r?.height.tablet||r.height};\n            }\n        }\n        @media screen and (max-width: 640px){\n            #${n} .online_3d_viewer,\n            #${n} .b3dviewer-wrapper {\n                width: ${a?"100%":`${r?.width.mobile||r.width}`};\n                height: ${r?.height.mobile||r.height};\n            }\n        }\n        #${n} model-viewer::part(default-progress-bar){\n            background: ${s};\n        }\n        #${n} .slides .slide{\n            width: ${i};\n            height: ${i};\n            padding: calc(${i} * 0.04);\n        }\n        #${n} .slide-number span{\n            font-size: calc(${i} * 0.8);\n        }\n        ${o?.CSS}\n    `.replaceAll(/\n?\s\s/g,"");u(e)},[n,r,o,l]),(0,t.createElement)("style",null,c)},u=({element:e})=>(0,t.createElement)("svg",{onClick:()=>{e&&("function"==typeof e.requestFullscreen?e.requestFullscreen():e.classList.add("fullscreen"))},id:"openBtn",width:"24px",height:"24px",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg",fill:"#222",className:"bi bi-arrows-fullscreen"},(0,t.createElement)("path",{fillRule:"even",d:"M5.828 10.172a.5.5 0 0 0-.707 0l-4.096 4.096V11.5a.5.5 0 0 0-1 0v3.975a.5.5 0 0 0 .5.5H4.5a.5.5 0 0 0 0-1H1.732l4.096-4.096a.5.5 0 0 0 0-.707zm4.344 0a.5.5 0 0 1 .707 0l4.096 4.096V11.5a.5.5 0 1 1 1 0v3.975a.5.5 0 0 1-.5.5H11.5a.5.5 0 0 1 0-1h2.768l-4.096-4.096a.5.5 0 0 1 0-.707zm0-4.344a.5.5 0 0 0 .707 0l4.096-4.096V4.5a.5.5 0 1 0 1 0V.525a.5.5 0 0 0-.5-.5H11.5a.5.5 0 0 0 0 1h2.768l-4.096 4.096a.5.5 0 0 0 0 .707zm-4.344 0a.5.5 0 0 1-.707 0L1.025 1.732V4.5a.5.5 0 0 1-1 0V.525a.5.5 0 0 1 .5-.5H4.5a.5.5 0 0 1 0 1H1.732l4.096 4.096a.5.5 0 0 1 0 .707z"})),d=({element:e})=>(0,t.createElement)("svg",{id:"closeBtn",onClick:function(){document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen(),e?.classList.remove("fullscreen")},className:"sidebar-open",width:"34px",height:"34px",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},(0,t.createElement)("path",{fill:"none",stroke:"#f2f2f2",strokeWidth:"2",d:"M7,7 L17,17 M7,17 L17,7"})),m=(e,t=[],r,n=!0)=>{if(e?.parentElement){n&&(e.parentElement.style.display="inline-block"),e.innerHTML="",!t.length&&e.parentElement&&(window.location.href.includes("wp-admin")?t[0]="not available":e.parentElement.style.display="none");for(const n of t){const t=document.createElement("option");t.value=n,t.textContent=n,e.appendChild(t),n===r&&(t.selected=!0)}}},p=({currentItem:e,setCurrentItem:r,models:n})=>(0,t.createElement)(t.Fragment,null,(0,t.createElement)("div",{className:"slideController"},(0,t.createElement)("svg",{fill:"#000000",onClick:()=>r(e>0?e-1:e),className:"arrow-left "+(e>0?"":"disabled"),width:"24px",height:"24px",viewBox:"-78.5 0 512 512",xmlns:"http://www.w3.org/2000/svg"},(0,t.createElement)("title",null,"left"),(0,t.createElement)("path",{d:"M257 64L291 98 128 262 291 426 257 460 61 262 257 64Z"})),(0,t.createElement)("svg",{onClick:()=>r(e<n.length-1?e+1:e),fill:"#000000",className:"arrow-right "+(e<n.length-1?"":"disabled"),width:"24px",height:"24px",viewBox:"-77 0 512 512",xmlns:"http://www.w3.org/2000/svg"},(0,t.createElement)("title",null,"right"),(0,t.createElement)("path",{d:"M98 460L64 426 227 262 64 98 98 64 294 262 98 460Z"})))),h=e.p+"images/posx.636c229f.jpg",g=e.p+"images/posy.0722c73e.jpg",b=e.p+"images/posz.829f9244.jpg",w=e.p+"images/negx.dad27d20.jpg",f=e.p+"images/negy.ef9d1d19.jpg",v=e.p+"images/negz.a6842016.jpg",y=({attributes:e,currentItem:r,setCurrentItem:n,isPagination:a})=>{const{multiple:l,woo:o,models:s}=e;return(0,t.createElement)(t.Fragment,null,l&&!o&&a&&(0,t.createElement)("div",{className:"slider"},(0,t.createElement)("div",{className:"slides"},s.map((e,a)=>(0,t.createElement)("button",{key:a,className:`slide ${a===r?"selected":""} ${e.poster?"":"slide-number"}`,"data-source":e?.modelUrl,"data-poster":e?.poster,onClick:()=>n(a)},e.poster?(0,t.createElement)("img",{src:e?.poster}):(0,t.createElement)("span",null,a+1))))))},E=e=>(0,t.createElement)("button",{...e}),x=e=>{const{attributes:n,currentItem:a,setCurrentItem:l,modelSrc:o,setAttributes:i,__:c}=e,{styles:u,models:d,multiple:m,O3DVSettings:x}=n,{isNavigation:S,isPagination:$,camera:T,mouseControl:A,zoom:C=!0,showEdge:M=!1,edgeColor:k}=x,[L,R]=(0,t.useState)(!1),V=(0,t.useRef)(null),N=(0,t.useRef)(null),I=(0,t.useRef)(null);return(0,t.useEffect)(()=>{if(o)if(N.current?.Destroy(),N.current?.canvas?.remove(),N.current=null,null===N.current){const e=T&&!m?{camera:new OV.Camera(new OV.Coord3D(...Object.values(T.eye)),new OV.Coord3D(...Object.values(T.center)),new OV.Coord3D(...Object.values(T.up)),45)}:{};I.current=new OV.EmbeddedViewer(V.current,{...e,backgroundColor:new OV.RGBAColor(255,255,255,255),edgeSettings:new OV.EdgeSettings(M,new OV.RGBColor(0,0,0),1),environmentSettings:new OV.EnvironmentSettings([h,g,b,w,f,v],!1)});const t=[o];I.current.LoadModelFromUrlList(t),N.current=I.current,window.VR=I.current,I.current.viewer.navigation.SetZoomStatus(C)}else{N.current.LoadModelFromUrlList([o]);const e=new OV.Coord3D(0,0,0);N.current.viewer.SetCamera(new OV.Camera(new OV.Coord3D(0,0,1),e,new OV.Coord3D(0,1,0),45))}return()=>{if(null!==N.current&&null!==V.current&&L){delete N.current.model,N.current.viewer.renderer.resetState(),N.current.viewer.Clear(),N.current.viewer&&delete N.current.viewer,N.current.canvas.getContext("webgl2").getExtension("WEBGL_lose_context").loseContext();const e=N.current.canvas.cloneNode(!0);N.current.canvas.parentNode.replaceChild(e,N.current.canvas),V.current?.removeChild(V.current.children[0]),N.current.canvas?.parentNode?.removeChild(N.current.canvas),N.current.canvas.remove(),N.current=null,R(!1)}}},[o]),(0,t.useEffect)(()=>{r(u.bgColor)&&N.current?.viewer?.SetBackgroundColor(r(u.bgColor)),setTimeout(()=>{N.current?.viewer?.Resize(V.current.offsetWidth,V.current.offsetHeight)},10),N.current.viewer.Render(),window.viewer=N.current},[u,o]),(0,t.useEffect)(()=>{window.addEventListener("resize",()=>{N.current?.viewer?.Resize(V.current?.offsetWidth,V.current?.offsetHeight)})},[]),(0,t.useEffect)(()=>{if(I.current){I.current.viewer.navigation.SetZoomStatus(C);const[e=0,t=0,r=0]=s(k)||[];I.current.viewer.SetEdgeSettings(new OV.EdgeSettings(M,new OV.RGBColor(255*e,255*t,255*r),0))}},[C,M,k]),(0,t.createElement)(t.Fragment,null,(0,t.createElement)("div",{ref:V,role:"img","aria-label":"Canvas showing the model in the 3D Viewer",className:`${A?"":"DMC"} ${N.current?.modelLoader?.inProgress} relative flex  flex-col items-center justify-center p-2 h-72 w-72 border-2 border-black rounded-sm online_3d_viewer`},(0,t.createElement)(y,{attributes:n,setCurrentItem:l,currentItem:a,isPagination:$}),m&&S&&d.length>1&&(0,t.createElement)(p,{currentItem:a,setCurrentItem:l,models:d}),i&&!m&&(0,t.createElement)("div",{className:"setDefaultViewContainer"},(0,t.createElement)(E,{variant:"primary",className:"setDefaultView button button-primary",onClick:()=>{if(N.current){const t=(e=N.current?.viewer?.GetCamera(),JSON.parse(JSON.stringify(e)));i({O3DVSettings:{...x,camera:t}})}var e}},c(T?"Reset Default View":"Set Default View","model-viewer")),T&&(0,t.createElement)(t.Fragment,null,(0,t.createElement)(E,{variant:"primary",className:"setDefaultView button button-primary",onClick:()=>{N.current?.viewer.SetCamera(new OV.Camera(new OV.Coord3D(...Object.values(T.eye)),new OV.Coord3D(...Object.values(T.center)),new OV.Coord3D(...Object.values(T.up)),45))}},c("See Default View","model-viewer")),(0,t.createElement)(E,{variant:"primary",className:"setDefaultView button button-primary",onClick:()=>i({O3DVSettings:{...x,camera:null}})},c("Remove Default View","model-viewer"))))))},S=e.p+"images/loading.0178ea4a.webp",$=({attributes:e,__:r,setAttributes:a,viewerRef:l,setModelReader:o})=>{const[s,i]=(0,t.useState)(!1),{loadingPercentage:h=!1,uniqueId:g,model:b,models:w,fullscreen:f,exposure:v,variant:y,multiple:E,additional:$,selectedAnimation:T,animation:A,autoRotate:C,rotateDelay:M,autoplay:k,rotateAlongX:L,align:R,woo:V,rotationPerSecond:N,preload:I,isPagination:_,isNavigation:B,zoom:D,currentViewer:O="modelViewer",O3DVSettings:q={},loading:F,texture:j={},environmentImage:z,zoomLevel:P=1,toneMapping:U,appliedTextures:H}=e,{isFullscreen:W}=q,[G,Z]=(0,t.useState)(0),[J,Q]=(0,t.useState)(E?w[G]?.modelUrl:b?.modelUrl),X=(0,t.useMemo)(()=>E?w[G]:b,[w[G],b]),[Y,K]=(0,t.useState)(null),ee=(0,t.useRef)(),te=(0,t.useRef)();(0,t.useEffect)(()=>{Q(E?w[G]?.modelUrl:b?.modelUrl)},[G,E,w,b]),(0,t.useEffect)(()=>{try{new URL(J),i(!0)}catch(e){i(!1)}setTimeout(()=>{((e={})=>{const{animation:t=!1,variant:r=!1,wrapper:n}=e;if(!n)return;const a=n.querySelector("model-viewer");if(!a)return!1;if(a.src)try{const e=new URL(a.src);e?.protocol!==window.location.protocol&&(a.src=e.href.replace(e.protocol,window.location.protocol))}catch(e){console.warn(e.message,a.src)}const l=a.dataset.animation,o=n.querySelector("#variant"),s=n.querySelector("#animations"),i=n.querySelector(".percentageWrapper"),c=n.querySelector(".loader"),u=i?.querySelector(".percentage");i&&("interaction"===a.reveal||a.loaded)&&(i.style.display="none"),c&&("interaction"===a.reveal||a.loaded)&&(c.style.display="none"),a.addEventListener("load",()=>{m(o,a.availableVariants,"",r),m(s,a.availableAnimations,l,t),a.animationName=l,setTimeout(()=>{i&&(i.style.display="none")},100)});const d=setInterval(()=>{a.loaded&&clearInterval(d),i&&(i.style.display="none")},5e3);u&&a.addEventListener("progress",e=>{i.style.display="block",u.innerHTML=parseInt(100*e.detail.totalProgress)+"%"}),o&&o.addEventListener("input",e=>{a.variantName=e.target.value}),s&&s.addEventListener("input",e=>{a.animationName=e.target.value});const p=n.querySelectorAll(".slide");for(const e of p)e.addEventListener("click",t=>{t.preventDefault(),a.src=e?.dataset?.source,a.poster=e?.dataset?.poster,p.forEach(e=>{e.classList.remove("selected")}),e.classList.add("selected"),o&&(o.innerHTML="")});document.querySelector(".slider")?.addEventListener("beforexrselect",e=>{e.preventDefault()})})({animation:A,variant:y,wrapper:l.current?.parentElement})},10)},[g,b,w,E,J]),(0,t.useEffect)(()=>{k||l.current?.pause()},[k]),(0,t.useEffect)(()=>{setTimeout(()=>{l.current&&te.current&&(l.current.animationName=T,te.current.querySelector("select").value=T)},10)},[T]),(0,t.useEffect)(()=>{ee.current&&(ee.current.style.display=y?"inline-block":"none")},[y]),(0,t.useEffect)(()=>{te.current&&(A&&l.current.loaded?te.current.style.display="inline-block":te.current.style.display="none")},[A,te]),(0,t.useEffect)(()=>{l.current?.turntableRotation&&l.current.resetTurntableRotation()},[L]),(0,t.useEffect)(()=>{setTimeout(()=>{const{mouseControl:t,autoplay:r,shadow:n,rotate:a,rotateAlongX:o,rotateAlongY:s,loading:i}=e,c=e.useEnvironmentAsSkybox?ae:ne||null;l.current&&(t?l.current.setAttribute("camera-controls",""):l.current.removeAttribute("camera-controls"),r?l.current.setAttribute("autoplay",""):l.current.removeAttribute("autoplay"),n?l.current.setAttribute("shadow-intensity","1"):l.current.removeAttribute("shadow-intensity"),n?l.current.setAttribute("shadow-softness","1"):l.current.removeAttribute("shadow-softness"),i?l.current.setAttribute("loading",i):l.current.removeAttribute("loading"),c?(l.current.setAttribute("skybox-image",c),l.current.setAttribute("skybox-height",X.skyboxHeight||"0m")):l.current.removeAttribute("skybox-image"),C?(l.current.setAttribute("auto-rotate",""),l.current.setAttribute("auto-rotate-delay",M||3e3),l.current.setAttribute("rotation-per-second",N+"deg")):l.current.removeAttribute("auto-rotate"),a?l.current.setAttribute("camera-orbit",`${o}deg ${s}deg 105%`):l.current.removeAttribute("camera-orbit"),l.current.setAttribute("reveal",I),l.current.dataset.animation=T,l.current.setAttribute("exposure",X?.exposure||v),D?l.current.removeAttribute("disable-zoom"):l.current.setAttribute("disable-zoom",""),l.current?.addEventListener("load",function(){l.current.setAttribute("scale",`${P} ${P} ${P}`)}),l.current?.loaded&&l.current.setAttribute("scale",`${P} ${P} ${P}`)),setTimeout(()=>{a?l.current?.setAttribute("camera-orbit",`${o}deg ${s}deg 105%`):l.current?.removeAttribute("camera-orbit")},500)},10)},[g,e]),(0,t.useEffect)(()=>{const e=async()=>{const e=new n(l.current);o(e),e.onReady(()=>{e.applyTexture(H)}),window.appliedTextures=H};return setTimeout(()=>{l?.current?.loaded?e():l?.current?.addEventListener("load",e)},20),()=>{l.current?.removeEventListener("load",e)}},[b.modelUrl,O]),(0,t.useEffect)(()=>{if(V){if((e=>{document.querySelectorAll(".variations_form .variations select")?.forEach(t=>{const r={};r[t.name]=t.value,t.addEventListener("change",function(r){e(e=>({...e,[t.name]:t.value}))}),e(r)})})(K),le.current){const e=document.querySelector(".wl-single-slider:not(.slick-cloned)");e&&!e.querySelector(".modelViewerBlock")&&(e.append(le.current.parentElement),le.current.parentElement.style.display="none",setTimeout(()=>{},100)),(e=>{const t=document.querySelector("table.variations");if(!t)return;const r=t.querySelectorAll(".label label"),n={};r?.forEach(e=>{n[`attribute_${e.getAttribute("for")}`]=""}),e(n),t.querySelectorAll("tr")?.forEach(t=>{const r=t?.querySelector(".label label")?.getAttribute("for");t.querySelectorAll(".swatchly-swatch")?.forEach(t=>{t.addEventListener("click",()=>{n[`attribute_${r}`]=t.getAttribute("data-attr_value"),e(e=>({...e,[`attribute_${r}`]:t.getAttribute("data-attr_value")}))})})})})(K)}setTimeout(()=>{const e=document.querySelector(".select2-selection__rendered"),t=new MutationObserver(function(t){for(const r of t)if("childList"===r.type&&r.target===e){const t=w.find(t=>t.product_variant===e.innerText)||w.find(e=>"all"===e.product_variant)||w?.[0];Q(t.modelUrl)}});if(e){const r={childList:!0,subtree:!0};t.observe(e,r)}},1e3)}return()=>{}},[V]),(0,t.useEffect)(()=>{X&&l.current&&setTimeout(()=>{const{arEnabled:e,arPlacement:t="floor",arMode:r="quick-look",modelISOSrc:n}=X||{};e?(l.current.setAttribute("ar",""),l.current.setAttribute("ar-placement",t),l.current.setAttribute("ar-mode",r),l.current.setAttribute("ios-src",n),l.current.removeAttribute("ar-status")):(l.current.removeAttribute("ar"),l.current.removeAttribute("ar-placement"),l.current.removeAttribute("ar-mode"))},100)},[X,l.current]);const re=X?.poster,ne=X.skyboxImage,ae=X.environmentImage||z,le=(0,t.useRef)();return(0,t.useEffect)(()=>{if("object"==typeof Y&&Y&&Object.values(Y).every(e=>null!==e&&""!==e&&void 0!==e)){const e=w.find(e=>{const t=Object.keys(Y)[0];return e[t]?Object.entries(Y).every(([t,r])=>[r,"all"].includes(e[t])):[Y[t],"all"].includes(e.product_variant)})||w?.[1];Q(e?.modelUrl)}},[Y]),J?(0,t.createElement)("div",{ref:le,id:`${g}`,className:`modelViewerBlock b3dviewer align${R} ${V?"woocommerce":""} ${_&&E?"modelPagination":""}`},(0,t.createElement)("div",{id:$?.ID||"additional_id",className:`${$?.Class} b3dviewer-wrapper bp_model_parent`},(0,t.createElement)(c,{attributes:e}),J&&s&&(0,t.createElement)(t.Fragment,null,"modelViewer"===O?(0,t.createElement)("model-viewer",{loading:F||"auto","camera-controls":!0,ref:l,"data-js-focus-visible":!0,"data-decoder":E?w[0]?.decoder:b?.decoder,poster:re?.replace(/https?:/,window.location.protocol),src:J?.replace(/https?:/,window.location.protocol),exposure:X?.exposure||v,alt:"A 3D model",scale:"1 1 1","environment-image":ae,channel:j.type,texture:j.image,"skybox-image":ne,"skybox-height":"1.5m","tone-mapping":U,"ar-placement":X.arPlacement||"floor","ar-modes":"webxr scene-viewer quick-look","ar-scale":X.arScale||"auto"},(0,t.createElement)("button",{type:"button",slot:"poster",id:"default-poster","aria-label":"A 3D model",style:re?{backgroundImage:` url("${re?.replace(/https?:/,window.location.protocol)}")`}:{}}),h&&!l.current?.loaded&&(0,t.createElement)("div",{className:"percentageWrapper",slot:"progress-bar"},(0,t.createElement)("div",{className:"overlay"}),(0,t.createElement)("span",{className:"percentage"},"0%")),!l.current?.loaded&&!h&&(0,t.createElement)("div",{className:"bp3d_loader",slot:"progress-bar"},(0,t.createElement)("div",{className:"overlay"}),(0,t.createElement)("img",{style:{width:"100px",background:"white",borderRadius:"5px",height:"auto"},src:S})),(0,t.createElement)("div",{className:"variantWrapper select",ref:ee},r("Variant","model-viewer")," ",(0,t.createElement)("select",{id:"variant"})),(0,t.createElement)("div",{className:"animationWrapper select",ref:te},r("Animations","model-viewer")," ",(0,t.createElement)("select",{id:"animations"})),E&&!V&&_&&(0,t.createElement)("div",{className:"slider"},(0,t.createElement)("div",{className:"slides"},w.map((e,r)=>(0,t.createElement)("button",{key:r,className:`slide ${0===r?"selected":""} ${e.poster?"":"slide-number"}`,"data-source":e?.modelUrl,"data-poster":e?.poster,onClick:()=>Z(r)},e.poster?(0,t.createElement)("img",{src:e?.poster}):(0,t.createElement)("span",null,r+1))))),E&&B&&w.length>1&&(0,t.createElement)(p,{currentItem:G,setCurrentItem:Z,models:w})):(0,t.createElement)(t.Fragment,null,(0,t.createElement)(x,{__:r,setAttributes:a,modelSrc:J,currentItem:G,setCurrentItem:Z,model:J,attributes:e}))),""===J&&w[G].poster&&(0,t.createElement)(t.Fragment,null,V&&w.length>1&&(0,t.createElement)(p,{currentItem:G,setCurrentItem:Z,models:w}),(0,t.createElement)("img",{src:w[G].poster})),(f&&"modelViewer"===O||"O3DViewer"===O&&W)&&(0,t.createElement)(t.Fragment,null,(0,t.createElement)(u,{element:le.current?.querySelector(".bp_model_parent")}),(0,t.createElement)(d,{element:le.current?.querySelector(".bp_model_parent")}))),V&&_&&(0,t.createElement)("div",{className:"modelThumbs"},w.map((e,r)=>(0,t.createElement)(t.Fragment,null,e.poster&&(0,t.createElement)("img",{className:"thumbsItem "+(r===G?"selected":""),onClick:()=>Z(r),src:e.poster}))))):(0,t.createElement)(t.Fragment,null)};window.modelViewerMessages=[];const T=({attributes:e})=>{const[r,n]=(0,t.useState)(null),a=(0,t.useRef)();if(window.modelViewerMessages.push({attributes:e,viewerRef:a}),e)return(0,t.createElement)($,{attributes:e,viewerRef:a,__:function(e,t=""){return e},modelReader:r,setModelReader:n})},{createRoot:A}=ReactDOM,C=({div:e,dom:r,position:n,styles:a,attributes:l,isPagination:o,type:s})=>{if("bottom"===n?setTimeout(()=>{r.appendChild(e),(r=e).setAttribute("style",`width:${r.offsetWidth>0?r.offsetWidth+"px":"100%"};height:calc(${a.height} + ${o?"100px":"0px"})`),A(r).render((0,t.createElement)(T,{attributes:l}),r)},100):"top"===n?(r.insertBefore(e,r.firstChild),r=e,setTimeout(()=>{r.setAttribute("style",`width:${r.offsetWidth>0?r.offsetWidth+"px":"100%"};height:calc(${a.height} + ${o?"100px":"0px"})`),A(r).render((0,t.createElement)(T,{attributes:l}),r)},100)):(r.setAttribute("style",`width:${r.offsetWidth>0?r.offsetWidth+"px":"100%"};height:calc(${a.height} + ${o&&"popup"!==s?"100px":"0px"})`),A(r).render((0,t.createElement)(T,{attributes:l}),r)),r.classList.contains("productListItem")){const e=r.classList.contains("block-theme")?"previousElementSibling":"nextElementSibling",t=r[e]?.offsetHeight;if(t){r.style.height=t+"px",r[e].style.display="none";const n=setTimeout(()=>{r.querySelector(".modelViewerBlock")&&(clearInterval(n),r.querySelector(".modelViewerBlock").style.height=t+"px",r.querySelector(".bp_model_parent").setAttribute("style",`height:${t+"px"};min-width: 100%`),function(e){let t=e.parentElement;for(;t&&"A"===t.tagName;)e=t,t=t.parentElement;return e}(r).addEventListener("click",function(e){"openBtn"!==e.target.id&&"closeBtn"!==e.target.id&&"MODEL-VIEWER"!==e.target.tagName||e.preventDefault()}))},500)}}};document.addEventListener("DOMContentLoaded",function(){const e=document.querySelectorAll(".modelViewerBlock");setTimeout(()=>{Object.values(e).map(e=>{const t=e.querySelectorAll("model-viewer")||e.querySelectorAll(".online_3d_viewer"),r=e.querySelector(".progress");t.forEach(e=>{const t=new URL(e?.src||e?.getAttribute("src")||e?.getAttribute("model"));if("DIV"===e.tagName)console.log("Advanced viewer");else{t?.protocol!==location?.protocol&&e?.setAttribute("src",t.href.replace(t?.protocol,location?.protocol)),r&&(e?.addEventListener("progress",e=>{r.innerHTML=parseInt(100*e.detail.totalProgress)+"%"}),e?.addEventListener("load",()=>{setTimeout(()=>{r.style.display="none"},500)})),e.dataset.items="";const n=document.querySelector(".product-modal-wrap");if(n&&!n?.nextElementSibling?.classList?.contains("entry-summary")&&!n?.nextElementSibling?.classList?.contains("mkd-single-product-summary")){n.classList.add("model-full-width");const e=document.querySelector(".showcase-inner .product-information");if(e){const t=n.querySelector("model-viewer");t&&(t.style.height=e.offsetHeight+"px")}}}})})},1e3),document.querySelectorAll(".bp3dv-model-main")?.forEach(e=>{let t=e.dataset.selector;if(!t||""===t)return!1;let r=i(t);r?(r?.addEventListener("click",t=>{t.preventDefault(),e.classList.add("model-open"),window.dispatchEvent(new Event("resize"))}),r.style.cursor="pointer",e.querySelector(".close-btn").addEventListener("click",()=>e.classList.remove("model-open")),e.querySelector(".bg-overlay").addEventListener("click",()=>e.classList.remove("model-open"))):console.warn("clickable item is not found",t)})}),window.jQuery&&jQuery(document).ready(function(e){e(".bp3dmodel-carousel")?.[0]?.slick({slidesToShow:1,slidesToScroll:1,arrows:!0})}),document.addEventListener("DOMContentLoaded",function(){const e=document.querySelectorAll(".modelViewerBlock");window.domRendered||(window.domRendered=!0,e.forEach(e=>{const t={...e.dataset}||{};setTimeout(()=>{Object.keys(e.dataset).map(t=>delete e.dataset[t])},10);const r=(e=>{let t=null;try{t=JSON.parse(e)}catch(e){console.warn(e.message)}return t})(t.attributes);if(r){const n=t.selector,a=t.position,l=t.uniqueClass,o=t.type,{isPagination:s,styles:c}=r,u=document.createElement("div");if(!(n&&i(n)?(Object.keys(e.dataset).map(t=>delete e.dataset[t]),e=i(n)):window.modelViewerMessages.push({dom:e,selector:n,message:"does not have any dom with this selector"}),r?.currentViewer&&"modelViewer"!==r.currentViewer||(e.setAttribute("data-rendered","true"),u.classList.add("woocommerce-product-model-viewer-wrapper"),u.classList.add(`position_${a}`),e.classList.add(`product_${l}`),C({div:u,dom:e,position:a,styles:c,isPagination:s,attributes:r,type:o}),document.getElementById("bp3d-model-viewer-js")))){const e=document.createElement("script");e.type="module",e.id="bp3d-model-viewer-js",e.src=window.bp3dBlock?.modelViewerSrc,document.head.appendChild(e)}if("O3DViewer"===r.currentViewer){const t=document.getElementById("bp3d-o3dviewer-js");if(t)window.OV&&C({div:u,dom:e,position:a,styles:c,isPagination:s,attributes:r,type:o}),t.addEventListener("load",()=>{C({div:u,dom:e,position:a,styles:c,isPagination:s,attributes:r,type:o})});else{const t=document.createElement("script");t.id="bp3d-o3dviewer-js",t.src=window.bp3dBlock?.o3dviewerSrc,document.head.appendChild(t),t.addEventListener("load",()=>{C({div:u,dom:e,position:a,styles:c,isPagination:s,attributes:r,type:o})})}}}}))})})();