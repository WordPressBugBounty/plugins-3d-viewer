(()=>{"use strict";var e={795:e=>{e.exports=window.ReactDOM},822:(e,t,r)=>{var n=r(795);t.H=n.createRoot,n.hydrateRoot}},t={};function r(n){var a=t[n];if(void 0!==a)return a.exports;var o=t[n]={exports:{}};return e[n](o,o.exports,r),o.exports}r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),(()=>{var e;r.g.importScripts&&(e=r.g.location+"");var t=r.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var a=n.length-1;a>-1&&(!e||!/^http(s?):/.test(e));)e=n[a--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),r.p=e})();const n=window.React,a=function(e,t="string"){if(e){if("transparent"===e)return{r:255,g:255,b:255,a:0};if(e.includes("rgba")){const t=e.match(/rgba?\((\d+),(\d+),(\d+)(?:,([\d.]+))?\)/);if(t){const[,e,r,n,a=1]=t.map(Number);return{r:e,g:r,b:n,a}}return null}var r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})?$/i.exec(e.replace("#",""));return r?{r:parseInt(r[1],16),g:parseInt(r[2],16),b:parseInt(r[3],16),a:parseInt(r[4],16)?parseInt(r[4],16):0===parseInt(r[4],16)?0:255}:null}},o=class{constructor(e){window.model=e,this.model=e,this.copy=null,this.thumbnailsById=new Map,this.thumbnail_size=256,this.textures=[],this.texturesArray=[],this.textureChannels=[],this.defaultMaterialData=null,this.initialized=!1,this.sizes=[],this.copy=null,this.readyCallbacks=[],this.isReady=!1,this.model.loaded?this.onLoad():this.model.addEventListener("load",this.onLoad.bind(this))}initialize(){this.isReady=!0,this.readyCallbacks.forEach((e=>e())),this.readyCallbacks=[]}onReady(e){this.isReady?e():this.readyCallbacks.push(e)}async onLoad(){if(this.modelUrl=this.model.src,this.getDefaultMaterialData(),this.thumbnailsById=await this.createThumbnails(),window.pagenow){const e=await this.loadModelWithoutAppending(this.model.src+"?"+Date.now());this.copy=e.model;const t=await this.createThumbnails(new Map,this.copy.materials);this.copy.thumbnailsById=t}this.initialize()}getTextureId(e){var t;return null!==(t=e.uri)&&void 0!==t?t:e.bufferView.toString()}async getTextures(){return 0===Object.keys(this.textures).length&&this.model&&await this.createThumbnails(),this.textures}async getBlobFileSize(e){try{const t=await fetch(e);if(!t.ok)throw new Error("Failed to fetch the Blob URL");return(await t.blob()).size}catch(e){return console.error("Error getting Blob file size:",e),null}}async pushThumbnail(e,t){const{texture:r}=t||{};if(!r||!r.source)return null;const n=this.getTextureId(r.source);if(!e.has(n)){const t=await r.source.createThumbnail(this.thumbnail_size,this.thumbnail_size),a=await this.getBlobFileSize(t);e.set(n,{objectUrl:t,texture:r,size:a,id:n}),this.textures[n]||(this.texturesArray.push(n),this.textures[n]=t,this.sizes[n+"_"+a]=t)}return n}async createThumbnails(e,t=this.model.model?.materials){e||(e=new Map);for(const r of t||[]){await r.ensureLoaded();const{pbrMetallicRoughness:t,normalTexture:n,emissiveTexture:a,occlusionTexture:o}=r,{baseColorTexture:l,metallicRoughnessTexture:s}=t;await this.pushThumbnail(e,n),await this.pushThumbnail(e,a),await this.pushThumbnail(e,o),await this.pushThumbnail(e,l),await this.pushThumbnail(e,s)}return e}getAllMaterialData(){if(!this.model.model)return console.warn("Model not loaded yet."),{};const e={};return this.model.model.materials.forEach((async t=>{await t.ensureLoaded();const r=t.name||`Material_${Math.random().toString(36).substr(2,5)}`;e[r]={baseColor:{texture:{name:t.pbrMetallicRoughness.baseColorTexture?.texture?.source.name||null,uri:t.pbrMetallicRoughness.baseColorTexture?.texture?.source.uri||null},factor:t.pbrMetallicRoughness.baseColorFactor||[1,1,1,1]},metallicRoughness:{texture:{name:t.pbrMetallicRoughness.metallicRoughnessTexture?.texture?.source.name||null,uri:t.pbrMetallicRoughness.metallicRoughnessTexture?.texture?.source.uri||null},factor:[t.pbrMetallicRoughness.metallicFactor||1,t.pbrMetallicRoughness.roughnessFactor||1]},normal:{texture:{uri:t.normalTexture?.texture?.source.uri||null,name:t.normalTexture?.texture?.source.name||null}},emissive:{texture:{name:t.emissiveTexture?.texture?.source.name||null,uri:t.emissiveTexture?.texture?.source.uri||null},factor:t.emissiveFactor||[0,0,0]},occlusion:{texture:{name:t.occlusionTexture?.texture?.source.name||null,uri:t.occlusionTexture?.texture?.source.uri||null}}}})),e}getDefaultMaterialData(){return this.defaultMaterialData||(this.defaultMaterialData=this.getAllMaterialData()),this.defaultMaterialData}async updateMaterialTextureAndFactor(e,t,r,n=null,a=`texture_${Date.now()}`){if(this.model?.model&&e)if(r&&("baseColor"===t&&e.pbrMetallicRoughness.setBaseColorFactor(c(r)),"metallicRoughness"===t&&(e.pbrMetallicRoughness.setMetallicFactor(r[0]),e.pbrMetallicRoughness.setRoughnessFactor(r[1])),"emissive"===t&&e.setEmissiveFactor(c(r))),"default"!==n){if(!n)return t.includes("base")||t.includes("metallic")?e.pbrMetallicRoughness[t+"Texture"].setTexture(null):e[t+"Texture"].setTexture(null),void console.log(`Removed texture from '${t}' of material '${e.name}'.`);try{"string"==typeof n&&((n=await this.model.createTexture(n)).name=a),t.includes("base")||t.includes("metallic")?e.pbrMetallicRoughness[t+"Texture"].setTexture(n):e[t+"Texture"].setTexture(n),console.log(`Applied new texture ${a} to '${t}' of material '${e.name}'.`)}catch(e){console.error("Error creating texture:",e)}}else{if(t.includes("base")||t.includes("metallic")){const r=this.copy.getMaterialByName(e.name).pbrMetallicRoughness[t+"Texture"].texture;e.pbrMetallicRoughness[t+"Texture"].setTexture(r)}else{const r=this.copy.getMaterialByName(e.name)[t+"Texture"].texture;e[t+"Texture"].setTexture(r)}console.log(`Removed texture from '${t}' of material '${e.name}'.`)}else console.warn("Model or Material not found.")}async applyTexture(e,t=null,r=null){if(window.modelReader=this,e)if(t&&r){const{name:n,url:a}=e[t]?.[r]?.texture||{},o=this.model?.model?.getMaterialByName(t);let l=a||this.getTextureByName(n);e[t]?.[r]?.texture||(l="default");const s=e[t]?.[r]?.factor||null;this.updateMaterialTextureAndFactor(o,r,s,l,n)}else Object.entries(e).forEach((([e,t])=>{const r=this.model?.model?.getMaterialByName(e);r?Object.keys(t).forEach((e=>{const{name:n,url:a}=t[e]?.texture||{};let o=a||this.getTextureByName(n);t[e]?.texture||(o="default");const l=t[e]?.factor||null;this.updateMaterialTextureAndFactor(r,e,l,o,n)})):console.warn(`Material '${e}' not found.`)}))}async shakeMaterialFactor(e,t=500){if(!e)return;"string"==typeof e&&(e=this.getMaterialByName(e));const r=e.pbrMetallicRoughness.baseColorFactor.slice();e.pbrMetallicRoughness.setBaseColorFactor([1,0,0,1]),setTimeout((()=>{e.pbrMetallicRoughness.setBaseColorFactor(r)}),t)}getTextureURIByName(e){return e.includes("blob")?e:this.textures[e]||null}getMaterialByName(e){return this.model.model.getMaterialByName(e)}getTexturesArray(){return this.texturesArray}getTextureChannels(){return[{label:"Base Color",value:"baseColor"},{label:"Metallic Roughness",value:"metallicRoughness"},{label:"Normal Map",value:"normal"},{label:"Emissive",value:"emissive"},{label:"Occlusion",value:"occlusion"}]}getMaterialsNameForSelectControl(){return this.model.loaded?Array.isArray(this.model.model.materials)?this.model.model.materials.map((e=>({label:e.name.replace("_mtl","").replaceAll("_"," "),value:e.name}))):[]:(console.warn("Model not loaded yet"),[])}getFirstMaterialName(){return this.model.loaded&&this.model.model?Array.isArray(this.model.model.materials)?this.model.model.materials[0].name:null:(console.warn("Model not loaded yet"),null)}getTextureById(e){return this.thumbnailsById.get(e)}async downloadTexture(e,t=512){const{texture:r=null}=this.getTextureById(e);if(!r)return void console.error("Texture not found!");const n=await r.source.createThumbnail(t,t),a=document.createElement("canvas");a.width=t,a.height=t;const o=a.getContext("2d"),l=new Image;l.crossOrigin="anonymous",l.src=n,l.onload=()=>{o.drawImage(l,0,0,t,t);const r=document.createElement("a");r.href=a.toDataURL("image/png"),r.download=`texture_${e}.png`,r.click()},l.onerror=()=>{console.error("Failed to load texture image.")}}deepCloneModel(){const e=this.model.originalModel.clone(!0);return e.traverse((e=>{e.isMesh&&(e.material&&(e.material=e.material.clone()),e.geometry&&(e.geometry=e.geometry.clone()),e.material.map&&(e.material.map=e.material.map.clone(),e.material.map.needsUpdate=!0))})),e}async loadModelWithoutAppending(e){return new Promise(((t,r)=>{const n=document.createElement("model-viewer");n.src=e,n.setAttribute("loading","eager"),n.style.display="none",n.style.height="0",document.body.appendChild(n),n.addEventListener("load",(()=>{t(n)})),n.addEventListener("error",(e=>{r(new Error(`Model failed to load: ${e.message}`))}))}))}getTextureByName(e){if(!e)return null;try{if(this.copy?.thumbnailsById)return this.copy.thumbnailsById.get(e).texture;if(this.thumbnailsById)return this.thumbnailsById.get(e)?.texture}catch(t){console.error(t.message,e)}return null}createCopy(){}};function l(e){return e.replace(/-\d{2,4}x\d{2,4}/g,"")}function s(e){return/\.(jpg|jpeg|png|gif|bmp|svg|webp)$/i.test(e)}function i(e){return(e/=255)<=.04045?e/12.92:((e+.055)/1.055)**2.4}function c(e){if(!["rgba","rgb"].includes((t=e,/^rgba\(\s*\d{1,3}\s*,\s*\d{1,3}\s*,\s*\d{1,3}\s*,\s*(0|1|0?\.\d+)\s*\)$/i.test(t)?"rgba":!!/^rgb\(\s*\d{1,3}\s*,\s*\d{1,3}\s*,\s*\d{1,3}\s*\)$/i.test(t)&&"rgb")))return e;var t;const r=e.match(/rgba?\((\d+),\s*(\d+),\s*(\d+),\s*([\d.]+)\)/);if(!r)return null;const[n,a,o,l,s]=r.map(Number);return[i(a),i(o),i(l),s]}function u(e){if(!e)return null;let t=document.querySelector(s(e)?`img[src="${e}"]`:e.includes("#")||e.includes(".")?e:`.${e}`);return s(e)&&(t||(t=document.querySelector(`img[data-src="${e}"]`)),t||(t=document.querySelector(`img[data-src="${l(e)}"]`)),t||(t=document.querySelector(`img[src="${l(e)}"]`)),t||(t=document.querySelector(`a[href="${l(e)}"]`))),t&&(t=function(e){let t=e.parentElement;for(;t&&1===t.children.length;)e=t,t=t.parentElement;return e}(t),t?.innerHTML?.includes("<a")&&t.classList.add("bp3dv_a_popup_opener"),t?.innerHTML?.includes("<img")&&"reintest.be"===window.location.host&&t.classList.add("bp3dv_play_icon")),t}var d=r(822);const m=({attributes:e})=>{const{styles:t,uniqueId:r,woo:a,progressBar:o,additional:l}=e,{progressBarColor:s,thumbSize:i="90px"}=t,[c,u]=(0,n.useState)(null);return(0,n.useEffect)((()=>{const e=`\n        #${r} {\n            width: ${t?.width?.desktop||t.width};\n            height: calc(${t?.height?.desktop||t.height});\n        }\n        .pop-up-content-wrap #${r} {\n            height: ${t?.height?.desktop||t.height};\n        }\n        #${r} .select {display: none}\n        \n        #${r} model-viewer {\n            background: ${t?.bgColor} ${t?.bgImage?`url(${t?.bgImage})`:" "} no-repeat center center;\n            background-size: cover;\n        }\n        #${r} model-viewer::part(default-progress-bar) {\n             display: ${o?"block":"none"}\n        }\n        #${r} .online_3d_viewer,\n        #${r} .b3dviewer-wrapper {\n            width: ${a?"100%":`${t?.width.desktop||t.width}`};\n            height: ${t?.height.desktop||t.height};\n        }\n        @media screen and (max-width: 1024px){\n            #${r} .online_3d_viewer,\n            #${r} .b3dviewer-wrapper {\n                width: ${a?"100%":`${t?.width.tablet||t.width}`};\n                height: ${t?.height.tablet||t.height};\n            }\n        }\n        @media screen and (max-width: 640px){\n            #${r} .online_3d_viewer,\n            #${r} .b3dviewer-wrapper {\n                width: ${a?"100%":`${t?.width.mobile||t.width}`};\n                height: ${t?.height.mobile||t.height};\n            }\n        }\n        #${r} model-viewer::part(default-progress-bar){\n            background: ${s};\n        }\n        #${r} .slides .slide{\n            width: ${i};\n            height: ${i};\n            padding: calc(${i} * 0.04);\n        }\n        #${r} .slide-number span{\n            font-size: calc(${i} * 0.8);\n        }\n        ${l?.CSS}\n    `.replaceAll(/\n?\s\s/g,"");u(e)}),[r,t,l,o]),(0,n.createElement)("style",null,c)},p=({element:e})=>(0,n.createElement)("svg",{onClick:()=>{e&&("function"==typeof e.requestFullscreen?e.requestFullscreen():e.classList.add("fullscreen"))},id:"openBtn",width:"24px",height:"24px",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg",fill:"#222",className:"bi bi-arrows-fullscreen"},(0,n.createElement)("path",{fillRule:"even",d:"M5.828 10.172a.5.5 0 0 0-.707 0l-4.096 4.096V11.5a.5.5 0 0 0-1 0v3.975a.5.5 0 0 0 .5.5H4.5a.5.5 0 0 0 0-1H1.732l4.096-4.096a.5.5 0 0 0 0-.707zm4.344 0a.5.5 0 0 1 .707 0l4.096 4.096V11.5a.5.5 0 1 1 1 0v3.975a.5.5 0 0 1-.5.5H11.5a.5.5 0 0 1 0-1h2.768l-4.096-4.096a.5.5 0 0 1 0-.707zm0-4.344a.5.5 0 0 0 .707 0l4.096-4.096V4.5a.5.5 0 1 0 1 0V.525a.5.5 0 0 0-.5-.5H11.5a.5.5 0 0 0 0 1h2.768l-4.096 4.096a.5.5 0 0 0 0 .707zm-4.344 0a.5.5 0 0 1-.707 0L1.025 1.732V4.5a.5.5 0 0 1-1 0V.525a.5.5 0 0 1 .5-.5H4.5a.5.5 0 0 1 0 1H1.732l4.096 4.096a.5.5 0 0 1 0 .707z"})),h=({element:e})=>(0,n.createElement)("svg",{id:"closeBtn",onClick:function(){document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen(),e?.classList.remove("fullscreen")},className:"sidebar-open",width:"34px",height:"34px",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},(0,n.createElement)("path",{fill:"none",stroke:"#f2f2f2",strokeWidth:"2",d:"M7,7 L17,17 M7,17 L17,7"})),g=(e,t=[],r,n=!0)=>{if(e?.parentElement){n&&(e.parentElement.style.display="inline-block"),e.innerHTML="",!t.length&&e.parentElement&&(window.location.href.includes("wp-admin")?t[0]="not available":e.parentElement.style.display="none");for(const n of t){const t=document.createElement("option");t.value=n,t.textContent=n,e.appendChild(t),n===r&&(t.selected=!0)}}},b=({currentItem:e,setCurrentItem:t,models:r})=>(0,n.createElement)(n.Fragment,null,(0,n.createElement)("div",{className:"slideController"},(0,n.createElement)("svg",{fill:"#000000",onClick:()=>t(e>0?e-1:e),className:"arrow-left "+(e>0?"":"disabled"),width:"24px",height:"24px",viewBox:"-78.5 0 512 512",xmlns:"http://www.w3.org/2000/svg"},(0,n.createElement)("title",null,"left"),(0,n.createElement)("path",{d:"M257 64L291 98 128 262 291 426 257 460 61 262 257 64Z"})),(0,n.createElement)("svg",{onClick:()=>t(e<r.length-1?e+1:e),fill:"#000000",className:"arrow-right "+(e<r.length-1?"":"disabled"),width:"24px",height:"24px",viewBox:"-77 0 512 512",xmlns:"http://www.w3.org/2000/svg"},(0,n.createElement)("title",null,"right"),(0,n.createElement)("path",{d:"M98 460L64 426 227 262 64 98 98 64 294 262 98 460Z"})))),w=r.p+"images/posx.636c229f.jpg",f=r.p+"images/posy.0722c73e.jpg",v=r.p+"images/posz.829f9244.jpg",y=r.p+"images/negx.dad27d20.jpg",E=r.p+"images/negy.ef9d1d19.jpg",x=r.p+"images/negz.a6842016.jpg",$=({attributes:e,currentItem:t,setCurrentItem:r,isPagination:a})=>{const{multiple:o,woo:l,models:s}=e;return(0,n.createElement)(n.Fragment,null,o&&!l&&a&&(0,n.createElement)("div",{className:"slider"},(0,n.createElement)("div",{className:"slides"},s.map(((e,a)=>(0,n.createElement)("button",{key:a,className:`slide ${a===t?"selected":""} ${e.poster?"":"slide-number"}`,"data-source":e?.modelUrl,"data-poster":e?.poster,onClick:()=>r(a)},e.poster?(0,n.createElement)("img",{src:e?.poster}):(0,n.createElement)("span",null,a+1)))))))},S=e=>(0,n.createElement)("button",{...e}),T=e=>{const{attributes:t,currentItem:r,setCurrentItem:o,modelSrc:l,setAttributes:s,__:i}=e,{styles:u,models:d,multiple:m,O3DVSettings:p}=t,{isNavigation:h,isPagination:g,camera:T,mouseControl:A,zoom:C=!0,showEdge:M=!1,edgeColor:L}=p,[R,k]=(0,n.useState)(!1),V=(0,n.useRef)(null),I=(0,n.useRef)(null),N=(0,n.useRef)(null);return(0,n.useEffect)((()=>{if(l)if(I.current?.Destroy(),I.current?.canvas?.remove(),I.current=null,null===I.current){const e=T&&!m?{camera:new OV.Camera(new OV.Coord3D(...Object.values(T.eye)),new OV.Coord3D(...Object.values(T.center)),new OV.Coord3D(...Object.values(T.up)),45)}:{};N.current=new OV.EmbeddedViewer(V.current,{...e,backgroundColor:new OV.RGBAColor(255,255,255,255),edgeSettings:new OV.EdgeSettings(M,new OV.RGBColor(0,0,0),1),environmentSettings:new OV.EnvironmentSettings([w,f,v,y,E,x],!1)});const t=[l];N.current.LoadModelFromUrlList(t),I.current=N.current,window.VR=N.current,N.current.viewer.navigation.SetZoomStatus(C)}else{I.current.LoadModelFromUrlList([l]);const e=new OV.Coord3D(0,0,0);I.current.viewer.SetCamera(new OV.Camera(new OV.Coord3D(0,0,1),e,new OV.Coord3D(0,1,0),45))}return()=>{if(null!==I.current&&null!==V.current&&R){delete I.current.model,I.current.viewer.renderer.resetState(),I.current.viewer.Clear(),I.current.viewer&&delete I.current.viewer,I.current.canvas.getContext("webgl2").getExtension("WEBGL_lose_context").loseContext();const e=I.current.canvas.cloneNode(!0);I.current.canvas.parentNode.replaceChild(e,I.current.canvas),V.current?.removeChild(V.current.children[0]),I.current.canvas?.parentNode?.removeChild(I.current.canvas),I.current.canvas.remove(),I.current=null,k(!1)}}}),[l]),(0,n.useEffect)((()=>{a(u.bgColor)&&I.current?.viewer?.SetBackgroundColor(a(u.bgColor)),setTimeout((()=>{I.current?.viewer?.Resize(V.current.offsetWidth,V.current.offsetHeight)}),10),I.current.viewer.Render(),window.viewer=I.current}),[u,l]),(0,n.useEffect)((()=>{window.addEventListener("resize",(()=>{I.current?.viewer?.Resize(V.current?.offsetWidth,V.current?.offsetHeight)}))}),[]),(0,n.useEffect)((()=>{if(N.current){N.current.viewer.navigation.SetZoomStatus(C);const[e=0,t=0,r=0]=c(L)||[];N.current.viewer.SetEdgeSettings(new OV.EdgeSettings(M,new OV.RGBColor(255*e,255*t,255*r),0))}}),[C,M,L]),(0,n.createElement)(n.Fragment,null,(0,n.createElement)("div",{ref:V,role:"img","aria-label":"Canvas showing the model in the 3D Viewer",className:`${A?"":"DMC"} ${I.current?.modelLoader?.inProgress} relative flex  flex-col items-center justify-center p-2 h-72 w-72 border-2 border-black rounded-sm online_3d_viewer`},(0,n.createElement)($,{attributes:t,setCurrentItem:o,currentItem:r,isPagination:g}),m&&h&&d.length>1&&(0,n.createElement)(b,{currentItem:r,setCurrentItem:o,models:d}),s&&!m&&(0,n.createElement)("div",{className:"setDefaultViewContainer"},(0,n.createElement)(S,{variant:"primary",className:"setDefaultView button button-primary",onClick:()=>{if(I.current){const t=(e=I.current?.viewer?.GetCamera(),JSON.parse(JSON.stringify(e)));s({O3DVSettings:{...p,camera:t}})}var e}},i(T?"Reset Default View":"Set Default View","model-viewer")),T&&(0,n.createElement)(n.Fragment,null,(0,n.createElement)(S,{variant:"primary",className:"setDefaultView button button-primary",onClick:()=>{I.current?.viewer.SetCamera(new OV.Camera(new OV.Coord3D(...Object.values(T.eye)),new OV.Coord3D(...Object.values(T.center)),new OV.Coord3D(...Object.values(T.up)),45))}},i("See Default View","model-viewer")),(0,n.createElement)(S,{variant:"primary",className:"setDefaultView button button-primary",onClick:()=>s({O3DVSettings:{...p,camera:null}})},i("Remove Default View","model-viewer"))))))},A=({attributes:e,__:t,setAttributes:r,viewerRef:a,setModelReader:l})=>{const[s,i]=(0,n.useState)(!1),{loadingPercentage:c=!1,uniqueId:u,model:d,models:w,fullscreen:f,exposure:v,variant:y,multiple:E,additional:x,selectedAnimation:$,animation:S,autoRotate:A,rotateDelay:C,autoplay:M,rotateAlongX:L,align:R,woo:k,rotationPerSecond:V,preload:I,isPagination:N,isNavigation:B,zoom:_,currentViewer:D="modelViewer",O3DVSettings:O={},loading:q,texture:F={},environmentImage:j,zoomLevel:z=1,toneMapping:U,appliedTextures:H}=e,{isFullscreen:P}=O,[W,G]=(0,n.useState)(0),[Z,J]=(0,n.useState)(E?w[W]?.modelUrl:d?.modelUrl),Q=(0,n.useMemo)((()=>E?w[W]:d),[w[W],d]),[X,Y]=(0,n.useState)(null),K=(0,n.useRef)(),ee=(0,n.useRef)();(0,n.useEffect)((()=>{J(E?w[W]?.modelUrl:d?.modelUrl)}),[W,E,w,d]),(0,n.useEffect)((()=>{try{new URL(Z),i(!0)}catch(e){i(!1)}setTimeout((()=>{((e={})=>{const{animation:t=!1,variant:r=!1,wrapper:n}=e;if(!n)return;const a=n.querySelector("model-viewer");if(!a)return!1;if(a.src)try{const e=new URL(a.src);e?.protocol!==window.location.protocol&&(a.src=e.href.replace(e.protocol,window.location.protocol))}catch(e){console.warn(e.message,a.src)}const o=a.dataset.animation,l=n.querySelector("#variant"),s=n.querySelector("#animations"),i=n.querySelector(".percentageWrapper"),c=i?.querySelector(".percentage");i&&("interaction"===a.reveal||a.loaded)&&(i.style.display="none"),a.addEventListener("load",(()=>{g(l,a.availableVariants,"",r),g(s,a.availableAnimations,o,t),a.animationName=o,setTimeout((()=>{i&&(i.style.display="none")}),100)}));const u=setInterval((()=>{a.loaded&&clearInterval(u),i&&(i.style.display="none")}),5e3);c&&a.addEventListener("progress",(e=>{i.style.display="block",c.innerHTML=parseInt(100*e.detail.totalProgress)+"%"})),l&&l.addEventListener("input",(e=>{a.variantName=e.target.value})),s&&s.addEventListener("input",(e=>{a.animationName=e.target.value}));const d=n.querySelectorAll(".slide");for(const e of d)e.addEventListener("click",(t=>{t.preventDefault(),a.src=e?.dataset?.source,a.poster=e?.dataset?.poster,d.forEach((e=>{e.classList.remove("selected")})),e.classList.add("selected"),l&&(l.innerHTML="")}));document.querySelector(".slider")?.addEventListener("beforexrselect",(e=>{e.preventDefault()}))})({animation:S,variant:y,wrapper:a.current?.parentElement})}),10)}),[u,d,w,E,Z]),(0,n.useEffect)((()=>{M||a.current?.pause()}),[M]),(0,n.useEffect)((()=>{setTimeout((()=>{a.current&&ee.current&&(a.current.animationName=$,ee.current.querySelector("select").value=$)}),10)}),[$]),(0,n.useEffect)((()=>{K.current&&(K.current.style.display=y?"inline-block":"none")}),[y]),(0,n.useEffect)((()=>{ee.current&&(S&&a.current.loaded?ee.current.style.display="inline-block":ee.current.style.display="none")}),[S,ee]),(0,n.useEffect)((()=>{a.current?.turntableRotation&&a.current.resetTurntableRotation()}),[L]),(0,n.useEffect)((()=>{setTimeout((()=>{const{mouseControl:t,autoplay:r,shadow:n,rotate:o,rotateAlongX:l,rotateAlongY:s,loading:i}=e,c=e.useEnvironmentAsSkybox?ne:re||null;a.current&&(t?a.current.setAttribute("camera-controls",""):a.current.removeAttribute("camera-controls"),r?a.current.setAttribute("autoplay",""):a.current.removeAttribute("autoplay"),n?a.current.setAttribute("shadow-intensity","1"):a.current.removeAttribute("shadow-intensity"),n?a.current.setAttribute("shadow-softness","1"):a.current.removeAttribute("shadow-softness"),i?a.current.setAttribute("loading",i):a.current.removeAttribute("loading"),c?a.current.setAttribute("skybox-image",c):a.current.removeAttribute("skybox-image"),A?(a.current.setAttribute("auto-rotate",""),a.current.setAttribute("auto-rotate-delay",C||3e3),a.current.setAttribute("rotation-per-second",V+"deg")):a.current.removeAttribute("auto-rotate"),o?a.current.setAttribute("camera-orbit",`${l}deg ${s}deg 105%`):a.current.removeAttribute("camera-orbit"),a.current.setAttribute("reveal",I),a.current.dataset.animation=$,a.current.setAttribute("exposure",Q?.exposure||v),_?a.current.removeAttribute("disable-zoom"):a.current.setAttribute("disable-zoom",""),a.current?.addEventListener("load",(function(){a.current.setAttribute("scale",`${z} ${z} ${z}`)})),a.current?.loaded&&a.current.setAttribute("scale",`${z} ${z} ${z}`)),setTimeout((()=>{o?a.current?.setAttribute("camera-orbit",`${l}deg ${s}deg 105%`):a.current?.removeAttribute("camera-orbit")}),500)}),10)}),[u,e]),(0,n.useEffect)((()=>{const e=async()=>{const e=new o(a.current);l(e),e.onReady((()=>{e.applyTexture(H)})),window.appliedTextures=H};return setTimeout((()=>{a?.current?.loaded?e():a?.current?.addEventListener("load",e)}),20),()=>{a.current?.removeEventListener("load",e)}}),[d.modelUrl,D]),(0,n.useEffect)((()=>{if(k){if((e=>{document.querySelectorAll(".variations_form .variations select")?.forEach((t=>{const r={};r[t.name]=t.value,t.addEventListener("change",(function(r){e((e=>({...e,[t.name]:t.value})))})),e(r)}))})(Y),ae.current){const e=document.querySelector(".wl-single-slider:not(.slick-cloned)");e&&!e.querySelector(".modelViewerBlock")&&(e.append(ae.current.parentElement),ae.current.parentElement.style.display="none",setTimeout((()=>{}),100)),(e=>{const t=document.querySelector("table.variations");if(!t)return;const r=t.querySelectorAll(".label label"),n={};r?.forEach((e=>{n[`attribute_${e.getAttribute("for")}`]=""})),e(n),t.querySelectorAll("tr")?.forEach((t=>{const r=t?.querySelector(".label label")?.getAttribute("for");t.querySelectorAll(".swatchly-swatch")?.forEach((t=>{t.addEventListener("click",(()=>{n[`attribute_${r}`]=t.getAttribute("data-attr_value"),e((e=>({...e,[`attribute_${r}`]:t.getAttribute("data-attr_value")})))}))}))}))})(Y)}setTimeout((()=>{const e=document.querySelector(".select2-selection__rendered"),t=new MutationObserver((function(t){for(const r of t)if("childList"===r.type&&r.target===e){const t=w.find((t=>t.product_variant===e.innerText))||w.find((e=>"all"===e.product_variant))||w?.[0];J(t.modelUrl)}}));if(e){const r={childList:!0,subtree:!0};t.observe(e,r)}}),1e3)}return()=>{}}),[k]),(0,n.useEffect)((()=>{Q.arEnabled&&a.current&&setTimeout((()=>{const{arEnabled:e,arPlacement:t="floor",arMode:r="quick-look",modelISOSrc:n}=Q||{};e?(a.current.setAttribute("ar",""),a.current.setAttribute("ar-placement",t),a.current.setAttribute("ar-mode",r),a.current.setAttribute("ios-src",n),a.current.removeAttribute("ar-status")):(a.current.removeAttribute("ar"),a.current.removeAttribute("ar-placement"),a.current.removeAttribute("ar-mode"))}),100)}),[Q]);const te=Q?.poster,re=Q.skyboxImage,ne=Q.environmentImage||j,ae=(0,n.useRef)();return(0,n.useEffect)((()=>{if("object"==typeof X&&X&&Object.values(X).every((e=>null!==e&&""!==e&&void 0!==e))){const e=w.find((e=>{const t=Object.keys(X)[0];return e[t]?Object.entries(X).every((([t,r])=>[r,"all"].includes(e[t]))):[X[t],"all"].includes(e.product_variant)}))||w?.[1];J(e?.modelUrl)}}),[X]),Z?(0,n.createElement)("div",{ref:ae,id:`${u}`,className:`modelViewerBlock b3dviewer align${R} ${k?"woocommerce":""} ${N&&E?"modelPagination":""}`},(0,n.createElement)("div",{id:x?.ID||"additional_id",className:`${x?.Class} b3dviewer-wrapper bp_model_parent`},(0,n.createElement)(m,{attributes:e}),Z&&s&&(0,n.createElement)(n.Fragment,null,"modelViewer"===D?(0,n.createElement)("model-viewer",{loading:q||"auto","camera-controls":!0,ref:a,"data-js-focus-visible":!0,"data-decoder":E?w[0]?.decoder:d?.decoder,poster:te?.replace(/https?:/,window.location.protocol),src:Z?.replace(/https?:/,window.location.protocol),exposure:Q?.exposure||v,alt:"A 3D model",scale:"1 1 1","environment-image":ne,channel:F.type,texture:F.image,"skybox-image":re,"tone-mapping":U,ar:Q.arEnabled,"ar-placement":Q.arPlacement||"floor","ar-modes":"webxr scene-viewer quick-look","ar-scale":Q.arScale||"auto"},(0,n.createElement)("button",{type:"button",slot:"poster",id:"default-poster","aria-label":"A 3D model",style:te?{backgroundImage:` url("${te?.replace(/https?:/,window.location.protocol)}")`}:{}}),c&&!a.current?.loaded&&(0,n.createElement)("div",{className:"percentageWrapper",slot:"progress-bar"},(0,n.createElement)("div",{className:"overlay"}),(0,n.createElement)("span",{className:"percentage"},"0%")),(0,n.createElement)("div",{className:"variantWrapper select",ref:K},t("Variant","model-viewer")," ",(0,n.createElement)("select",{id:"variant"})),(0,n.createElement)("div",{className:"animationWrapper select",ref:ee},t("Animations","model-viewer")," ",(0,n.createElement)("select",{id:"animations"})),E&&!k&&N&&(0,n.createElement)("div",{className:"slider"},(0,n.createElement)("div",{className:"slides"},w.map(((e,t)=>(0,n.createElement)("button",{key:t,className:`slide ${0===t?"selected":""} ${e.poster?"":"slide-number"}`,"data-source":e?.modelUrl,"data-poster":e?.poster,onClick:()=>G(t)},e.poster?(0,n.createElement)("img",{src:e?.poster}):(0,n.createElement)("span",null,t+1)))))),E&&B&&w.length>1&&(0,n.createElement)(b,{currentItem:W,setCurrentItem:G,models:w})):(0,n.createElement)(n.Fragment,null,(0,n.createElement)(T,{__:t,setAttributes:r,modelSrc:Z,currentItem:W,setCurrentItem:G,model:Z,attributes:e}))),""===Z&&w[W].poster&&(0,n.createElement)(n.Fragment,null,k&&w.length>1&&(0,n.createElement)(b,{currentItem:W,setCurrentItem:G,models:w}),(0,n.createElement)("img",{src:w[W].poster})),(f&&"modelViewer"===D||"O3DViewer"===D&&P)&&(0,n.createElement)(n.Fragment,null,(0,n.createElement)(p,{element:ae.current?.querySelector(".bp_model_parent")}),(0,n.createElement)(h,{element:ae.current?.querySelector(".bp_model_parent")}))),k&&N&&(0,n.createElement)("div",{className:"modelThumbs"},w.map(((e,t)=>(0,n.createElement)(n.Fragment,null,e.poster&&(0,n.createElement)("img",{className:"thumbsItem "+(t===W?"selected":""),onClick:()=>G(t),src:e.poster})))))):(0,n.createElement)(n.Fragment,null)};window.modelViewerMessages=[];const C=({attributes:e})=>{const[t,r]=(0,n.useState)(null),a=(0,n.useRef)();if(window.modelViewerMessages.push({attributes:e,viewerRef:a}),e)return(0,n.createElement)(A,{attributes:e,viewerRef:a,__:function(e,t=""){return e},modelReader:t,setModelReader:r})},M=({div:e,dom:t,position:r,styles:a,attributes:o,isPagination:l,type:s})=>{if("bottom"===r?setTimeout((()=>{t.appendChild(e),(t=e).setAttribute("style",`width:${t.offsetWidth>0?t.offsetWidth+"px":"100%"};height:calc(${a.height} + ${l?"100px":"0px"})`),(0,d.H)(t).render((0,n.createElement)(C,{attributes:o}),t)}),100):"top"===r?(t.insertBefore(e,t.firstChild),t=e,setTimeout((()=>{t.setAttribute("style",`width:${t.offsetWidth>0?t.offsetWidth+"px":"100%"};height:calc(${a.height} + ${l?"100px":"0px"})`),(0,d.H)(t).render((0,n.createElement)(C,{attributes:o}),t)}),100)):(t.setAttribute("style",`width:${t.offsetWidth>0?t.offsetWidth+"px":"100%"};height:calc(${a.height} + ${l&&"popup"!==s?"100px":"0px"})`),(0,d.H)(t).render((0,n.createElement)(C,{attributes:o}),t)),t.classList.contains("productListItem")){const e=t.classList.contains("block-theme")?"previousElementSibling":"nextElementSibling",r=t[e]?.offsetHeight;if(r){t.style.height=r+"px",t[e].style.display="none";const n=setTimeout((()=>{t.querySelector(".modelViewerBlock")&&(clearInterval(n),t.querySelector(".modelViewerBlock").style.height=r+"px",t.querySelector(".bp_model_parent").setAttribute("style",`height:${r+"px"};min-width: 100%`),function(e){let t=e.parentElement;for(;t&&"A"===t.tagName;)e=t,t=t.parentElement;return e}(t).addEventListener("click",(function(e){"openBtn"!==e.target.id&&"closeBtn"!==e.target.id&&"MODEL-VIEWER"!==e.target.tagName||e.preventDefault()})))}),500)}}};document.addEventListener("DOMContentLoaded",(function(){const e=document.querySelectorAll(".modelViewerBlock");setTimeout((()=>{Object.values(e).map((e=>{const t=e.querySelectorAll("model-viewer")||e.querySelectorAll(".online_3d_viewer"),r=e.querySelector(".progress");t.forEach((e=>{const t=new URL(e?.src||e?.getAttribute("src")||e?.getAttribute("model"));if("DIV"===e.tagName)console.log("Advanced viewer");else{t?.protocol!==location?.protocol&&e?.setAttribute("src",t.href.replace(t?.protocol,location?.protocol)),r&&(e?.addEventListener("progress",(e=>{r.innerHTML=parseInt(100*e.detail.totalProgress)+"%"})),e?.addEventListener("load",(()=>{setTimeout((()=>{r.style.display="none"}),500)}))),e.dataset.items="";const n=document.querySelector(".product-modal-wrap");if(n&&!n?.nextElementSibling?.classList?.contains("entry-summary")&&!n?.nextElementSibling?.classList?.contains("mkd-single-product-summary")){n.classList.add("model-full-width");const e=document.querySelector(".showcase-inner .product-information");if(e){const t=n.querySelector("model-viewer");t&&(t.style.height=e.offsetHeight+"px")}}}}))}))}),1e3),document.querySelectorAll(".bp3dv-model-main")?.forEach((e=>{let t=e.dataset.selector;if(!t||""===t)return!1;let r=u(t);r?(r?.addEventListener("click",(t=>{t.preventDefault(),e.classList.add("model-open"),window.dispatchEvent(new Event("resize"))})),r.style.cursor="pointer",e.querySelector(".close-btn").addEventListener("click",(()=>e.classList.remove("model-open"))),e.querySelector(".bg-overlay").addEventListener("click",(()=>e.classList.remove("model-open")))):console.warn("clickable item is not found",t)}))})),window.jQuery&&jQuery(document).ready((function(e){e(".bp3dmodel-carousel")?.[0]?.slick({slidesToShow:1,slidesToScroll:1,arrows:!0})})),document.addEventListener("DOMContentLoaded",(function(){const e=document.querySelectorAll(".modelViewerBlock");window.domRendered||(window.domRendered=!0,e.forEach((e=>{const t={...e.dataset}||{};setTimeout((()=>{Object.keys(e.dataset).map((t=>delete e.dataset[t]))}),10);const r=(e=>{let t=null;try{t=JSON.parse(e)}catch(e){console.warn(e.message)}return t})(t.attributes);if(r){const n=t.selector,a=t.position,o=t.uniqueClass,l=t.type,{isPagination:s,styles:i}=r,c=document.createElement("div");if(!(n&&u(n)?(Object.keys(e.dataset).map((t=>delete e.dataset[t])),e=u(n)):window.modelViewerMessages.push({dom:e,selector:n,message:"does not have any dom with this selector"}),r?.currentViewer&&"modelViewer"!==r.currentViewer||(e.setAttribute("data-rendered","true"),c.classList.add("woocommerce-product-model-viewer-wrapper"),c.classList.add(`position_${a}`),e.classList.add(`product_${o}`),M({div:c,dom:e,position:a,styles:i,isPagination:s,attributes:r,type:l}),document.getElementById("bp3d-model-viewer-js")))){const e=document.createElement("script");e.type="module",e.id="bp3d-model-viewer-js",e.src=window.bp3dBlock?.modelViewerSrc,document.head.appendChild(e)}if("O3DViewer"===r.currentViewer){const t=document.getElementById("bp3d-o3dviewer-js");if(t)t.addEventListener("load",(()=>{M({div:c,dom:e,position:a,styles:i,isPagination:s,attributes:r,type:l})}));else{const t=document.createElement("script");t.id="bp3d-o3dviewer-js",t.src=window.bp3dBlock?.o3dviewerSrc,document.head.appendChild(t),t.addEventListener("load",(()=>{M({div:c,dom:e,position:a,styles:i,isPagination:s,attributes:r,type:l})}))}}}})))}))})();
//# sourceMappingURL=frontend.js.map